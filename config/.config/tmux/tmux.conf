unbind C-b
set -g prefix C-a
bind a send-prefix

set -g default-shell /opt/homebrew/bin/fish
set -g mouse on
set -g base-index 1
setw -g pane-base-index 1
set -g renumber-windows on
set -g history-limit 10000

set -g default-terminal "tmux-256color"
set -as terminal-features "xterm-ghostty:RGB:hyperlinks"
set -g allow-passthrough on

bind | split-window -h -c "#{pane_current_path}"
bind - split-window -v -c "#{pane_current_path}"
unbind '"'
unbind %

bind r source-file ~/.config/tmux/tmux.conf \; display "Config reloaded!"

bind -n M-Left select-pane -L
bind -n M-Right select-pane -R
bind -n M-Up select-pane -U
bind -n M-Down select-pane -D

bind -n C-h select-pane -L
bind -n C-j select-pane -D
bind -n C-k select-pane -U
bind -n C-l select-pane -R

bind -r H resize-pane -L 5
bind -r J resize-pane -D 5
bind -r K resize-pane -U 5
bind -r L resize-pane -R 5

bind-key C-a display-popup -E -w 80% -h 70% -S 'fg=#3a4450' "bash ~/.config/tmux/scripts/ts.sh"
bind-key w display-popup -E -w 80% -h 70% -S 'fg=#3a4450' "bash ~/.config/tmux/scripts/ts.sh --windows"

set -s copy-command 'pbcopy'

setw -g mode-keys vi
bind-key -T copy-mode-vi v send-keys -X begin-selection
bind-key -T copy-mode-vi y send-keys -X copy-pipe-and-cancel
bind-key -T copy-mode-vi Y send-keys -X copy-line
bind-key -T copy-mode-vi Enter send-keys -X copy-pipe-and-cancel
bind-key -T copy-mode-vi MouseDragEnd1Pane send-keys -X copy-pipe-and-cancel

bind-key -T copy-mode-vi / command-prompt -i -p "(search down)" "send -X search-forward-incremental \"%%%\""
bind-key -T copy-mode-vi ? command-prompt -i -p "(search up)" "send -X search-backward-incremental \"%%%\""

set -g allow-rename on
setw -g automatic-rename on
set -g set-titles on
set -g set-titles-string '#{pane_title}'

set -g status-position bottom
set -g status-style 'bg=#232C34'
set -g status-left-length 100
set -g status-right-length 100
set -g status-left '#[fg=#191724,bg=#ebbcba,bold] #S #[fg=#ebbcba,bg=#2d3843]#[fg=#e0def4,bg=#2d3843]  #{b:pane_current_path} #{?window_zoomed_flag,#[fg=#f6c177] ,}#{?client_prefix,#[fg=#eb6f92] ,}#[fg=#2d3843,bg=#232C34]'
set -g status-right '#[fg=#2d3843,bg=#232C34]#[fg=#908caa,bg=#2d3843] #{pane_index}/#{window_panes} #[fg=#e0def4] %H:%M #[fg=#ebbcba,bg=#2d3843]#[fg=#191724,bg=#ebbcba,bold] %d/%m '
set -g status-justify left
set -g window-status-format '#[fg=#908caa,bg=#232C34] #I:#W '
set -g window-status-current-format '#[fg=#191724,bg=#908caa,bold] #I:#W '
set -g window-status-separator ''

set -g pane-border-style 'fg=#3a4450'
set -g pane-active-border-style 'fg=#908caa'
set -g popup-border-style 'fg=#3a4450'
set -g popup-border-lines rounded
set -g message-style 'bg=#1e1e2e fg=#cdd6f4'

bind-key b set-option status

set -sg escape-time 10
set -g focus-events on
set -g repeat-time 1000
setw -g monitor-activity on
set -g visual-activity off
setw -g aggressive-resize on

set-hook -g after-new-session 'run-shell -b "bash ~/.config/tmux/scripts/util-window.sh \"#{session_name}\""'

set -g @plugin 'tmux-plugins/tpm'
set -g @plugin 'tmux-plugins/tmux-yank'
set -g @plugin 'fcsonline/tmux-thumbs'
set -g @plugin 'laktak/extrakto'

set -g @yank_action 'copy-pipe'

set -g @thumbs-key F
set -g @thumbs-command 'echo -n {} | pbcopy'
set -g @thumbs-upcase-command 'echo -n {} | pbcopy'

set -g @extrakto_key 'Tab'
set -g @extrakto_copy_key 'y'
set -g @extrakto_insert_key 'Enter'
set -g @extrakto_clip_tool 'pbcopy'

run '~/.tmux/plugins/tpm/tpm'
